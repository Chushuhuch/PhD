\section{Свойства весовой функции}

Для краткости в этом параграфе будем опускать второй аргумент у функции $a$.

\begin{lm}
\label{weightSum}
Рассмотрим непрерывную функцию $a \ge 0$, заданную на $[-1,1]$ и для произвольных $s \le t \in [-1,1]$
удовлетворяющую условию
\begin{equation}
a( s ) + a ( t ) \ge a( 1 - t + s ).
\end{equation}
Тогда для любых $-1 \le t_1 \le t_2 \le \ldots \le t_n \le 1$ верно
\begin{align*}
\sum_{k=1}^n a(t_k) & \ge a( 1 - \sum_{k = 1}^n (-1)^k t_k ), & \text{ для четных $n$},&\\
\sum_{k=1}^n a(t_k) & \ge a( -\sum_{k = 1}^n (-1)^k t_k ),    & \text{ для нечетных $n$}.&
\end{align*}
\end{lm}

\begin{proof}
Будем доказывать по индукции. Для $n = 1$ утверждение тривиально.
Пусть теперь $n$ четное. Тогда, по предположению индукции,
$\sum_{k=1}^{n - 1} a(t_k) \ge a( -\sum_{k = 1}^{n - 1} (-1)^k t_k )$. Значит
$$\sum_{k = 1}^{n - 1} a( t_k ) + a( t_n ) \ge a( -\sum_{k = 1}^{n - 1} (-1)^k t_k ) + a( t_n ) \ge
a( 1 - \sum_{k = 1}^{n} (-1)^k t_k ).$$
В случае нечетного $n$ воспользуемся предположением индукции в следующем виде:
$\sum_{k=2}^n a(t_k) \ge a( 1 + \sum_{k = 2}^n (-1)^k t_k )$. Тогда
$$a( t_1 ) + \sum_{k = 2}^n a( t_k ) \ge a( t_1 ) + a( 1 + \sum_{k = 2}^{n} (-1)^k t_k ) \ge
a( -\sum_{k = 2}^{n} (-1)^k t_k + t_1 ) = a( -\sum_{k = 1}^{n} (-1)^k t_k ).$$
\end{proof}

\begin{rem}
Если вдобавок к условию леммы предположить, что функция $a$ четна, то выполняются также следующие неравенства:
\label{almostConcaveMultRem}
\begin{align*}
\sum_{k=1}^n a(t_k) & \ge a( -1 + \sum_{k = 1}^n (-1)^k t_k ), & \text{ для четных $n$},&\\
\sum_{k=1}^n a(t_k) & \ge a( \sum_{k = 1}^n (-1)^k t_k ),    & \text{ для нечетных $n$}.&
\end{align*}
\end{rem}

\begin{lm}
\label{periodicity}
{\bf 1} Пусть функция $a$ удовлетворяет условию (\ref{almostConcave}).
Если найдутся такие $-1 \le x_0 < x_1 < -1$, что $a(x_0) = 0$ и $a(x_1) = 0$,
то $a(1) = 0$ и либо $a([x_0, 1]) \equiv 0$,
либо множество ее нулей периодично на отрезке $[x_0, 1]$ с периодом $x_1 - x_0$
(или меньшим в целое число раз).

{\bf 2} Пусть функция $a$ удовлетворяет условию (\ref{almostConcave}) и четна.
Если найдется $-1 < x_0 < -1$, что $a(x_0) = 0$, то либо $a \equiv 0$, либо
она периодична на всем отрезке $[-1, 1]$ с периодом $x_0 + 1$
(или меньшим в целое число раз).
\end{lm}

\begin{proof}
{\bf 1} Возьмем в условии (\ref{almostConcave}) $s = t = x_0$. Тогда
$a(s) + a(t) = 0 \ge a(1 - t + s) = a(1) \ge 0$. Значит $a(1) = 0$.

При $s = x_0, t = x_1$ получим $a(x_0) + a(x_1) \ge a(1 - x_1 + x_0) = 0$.

Обозначим $x_k := x_0 + k( x_1 - x_0 )$.
По индукции можно доказать, что $a(x_k) = 0$.
База верна для $k = 0$.
Переход: $$a(x_0 + k(x_1 - x_0)) + a(1 - x_1 + x_0) \ge a(x_0 + (k + 1) (x_1 - x_0)).$$
Утверждение верно для $k$, удовлетворяющих $x_k < 1$.
Обозначим последнюю такую точку $x_k^{\max}$.

Далее, если $x_k^{\max} \neq 1 - x_1 + x_0$, процесс можно повторить, воспользовавшись для перехода
индукции точку $x_k^{\max}$ вместо $1 - x_1 + x_0$, а именно
$$a(x_0 + l (1 - x_k^{\max})) + a(x_k^{\max}) \ge a(x_0 + (l + 1) (1 - x_k^{\max}).$$

Тем самым, если $1 - x_k^{\max}$ несоизмеримо с $x_1 - x_0$, получим $a([x_0, 1]) \equiv 0$.
В противном случае мы, повторив процесс конечное число раз,
получим равномерно распределенные нули на отрезке $[x_0, 1]$.
Если в ходе этого процесса еще остались нули справа от $x_0$, не входящие в сетку, для них
тоже можно повторить данный процесс (подставив их вместо $x_1$), и получить, что либо $a([x_0, 1]) \equiv 0$, либо
новая сетка имеет размер, несоизмеримый со старой, и тогда тоже $a([x_0, 1]) \equiv 0$,
либо можно показать, что обе сетки являются частью одной более мелкой сетки нулей.

{\bf 2} Из предыдущего пункта и четности следует периодичность множества нулей на всем отрезке.
Обозначим расстояние между соседними нулями $\Delta$.

Тогда для произвольного $-1 \le x \le 1 - \Delta$ выполнено $$a(x) = a(x) + a(1 - \Delta) \ge a(x + \Delta).$$

С другой стороны, $-1 \le -(x + \Delta) \le 1 - \Delta$, и выполнено
$$a(x + \Delta) = a(-(x + \Delta)) + a(1 - \Delta) \ge a(-x) = a(x).$$

Тем самым, $a(x) = a(x + \Delta)$.
\end{proof}

\begin{lm}
\label{maxConcave}
Пусть функции $a_1$ и $a_2$ удовлетворяют неравенству (\ref{almostConcave}).
Тогда функция $a(x) = \max (a_1(x), a_2(x))$ тоже ему удовлетворяет.
\end{lm}
\begin{proof}
\begin{multline*}
a(1 + s + t ) = \max( a_1(1 + s + t), a_2(1 + s + t) ) \le
\max( a_1( s ) + a_1( t ), a_2( s ) + a_2( t ) ) \\
\le \max( a_1( s ), a_2( s ) ) + \max( a_1( t ), a_2( t ) ) =
a( s ) + a( t ).
\end{multline*}
\end{proof}

\begin{lm}
\label{piecewiseLinearConcave}
Пусть функция $a$ удовлетворяет неравенству (\ref{almostConcave}), $k \in \Nat$.
Тогда кусочно линейная функция $a_k$, интерполирующая функцию $a$ по узлам
$(-1 + \frac{2i}{k})$, $i = 0, 1, \dots, k$, тоже
удовлетворяет неравенству (\ref{almostConcave}).
\end{lm}
\begin{proof}
Пусть $s = -1 + \frac{2i}{k}$, $t = -1 + \frac{2j}{k}$.
Тогда неравенство выполняется для $a_k$, потому что оно выполняется для $a$,
а в этих точках они совпадают.

Пусть теперь $s = -1 + \frac{2i}{k}$, и $t \in [-1 + \frac{2j}{k}, -1 + \frac{2(j + 1)}{k}]$.

Рассмотрим линейную функцию $h_1(t) = a_k( 1 - t + s ) - a_k(t) - a_k(s)$.
Из уже доказанного следует, что $h_1(-1 + \frac{2j}{k}) \le 0$ и $h_1(-1 + \frac{2(j + 1)}{k}) \le 0$.
Значит, поскольку $h_1$ линейна, $h_1(t) \le 0$.
Тем самым, неравенство выполняется для любого $s \in -1 + \frac{2i}{k}$ и $t \in [-1, 1]$.

Рассмотрим функцию $h_2(y) = a_k(\frac{2j}{k}) - a_k(s - y) - a_k(t + y)$, где $1 - t + s = \frac{2j}{k}$.
Предположим, $s + y_0$ --- один из узлов интерполяции, тогда $t + y_0$ тоже будет узлом интерполяции.
Тем самым, $h_2(y_0) \le 0$.
В промежутках между такими $y_0$ функция $h_2$ линейна, границы области определения $h_2$ приходятся на узлы интерполяции,
значит $h_2(y) \le 0$ на всей области определения.

Рассмотрим функцию $h_3(s) = a_k( 1 - t + s ) - a_k(t) - a_k(s)$ для произвольного фиксированного $t \in [-1, 1]$.
Эта функция кусочно линейна, изломы на ней встречаются каждый раз, когда либо $s$, либо $1 - t + s$
приходится на узел интерполяции. Однако, мы уже доказали, что в этих точках $h_3(s) \le 0$.
Границы области определения $h_3$ приходятся на узлы интерполяции, тем самым, $h_3(s) \le 0$ всюду.
\end{proof}
