\section{Свойства весовой функции}
\label{sec:weight_properties}

Здесь мы получаем несколько следствий из условия (\ref{eq:almostConcave}) на вес.
Для удобства в пределах этого параграфа мы опускаем второй параметр веса: $a(x, v) = a(x)$;
очевидно, что все полученные свойства буду выполняться для любых $v$.

\begin{lm}
\label{lm:weight_periodicity}
\textbf{\textup{i)}}
Пусть функция $a$ удовлетворяет условию $(\ref{eq:almostConcave})$.
Если найдётся такое $x_0 \in [-1, 1]$, что $a(x_0) = 0$,
то либо $a \equiv 0$ на $[x_0, 1]$,
либо множество нулей функции $a$ периодично на $[x_0, 1]$, причем период нацело делит $1 - x_0$.

\textbf{\textup{ii)}}
Пусть функция $a$ удовлетворяет условию $(\ref{eq:almostConcave})$ и чётна.
Если найдётся такое $x_0 \in [-1, 1]$, что $a(x_0) = 0$,
то либо $a \equiv 0$,
либо функция $a$ периодична на отрезке $[-1, 1]$, причем период нацело делит $1 - x_0$.
\end{lm}

\begin{proof}
\textbf{\textup{i)}}
Прежде всего, заметим, что если для некоторых $s \le t$ выполнено $a(s) = a(t) = 0$,
то неравенство (\ref{eq:almostConcave}) влечёт
$$
0 = a(s) + a(t) \ge a(1 - (t - s)) \ge 0,
$$
то есть $a(1 - (t - s)) = 0$.
Подставив $s = t = x_0$, получаем $a(1) = 0$.

Точно так же, если $s \le 1 - t$ и $a(s) = a(1 - t) = 0$, то $a(s + t) = 0$.

Тем самым, множество нулей функции $a$ симметрично на отрезке $[x_0, 1]$,
и если $a(s) = a(s + \Delta) = 0$ ($\Delta \ge 0$),
то $a(s + k\Delta) = 0$, для $s + k\Delta \le 1$.
Отсюда следует, что множество корней либо периодично на отрезке $[x_0, 1]$, либо совпадает с ним.

\textbf{\textup{ii)}}
Периодичность нулей функции $a$ следует из её чётности и из первой части утверждения леммы.
Обозначим расстояние между соседними нулями за $\Delta$.

Тогда для $-1 \le x \le 1 - \Delta$ выполнено
$$
a(x) = a(x) + a(1 - \Delta) \ge a(x + \Delta).
$$

С другой стороны, $-1 \le -(x + \Delta) \le 1 - \Delta$, и
$$
a(x + \Delta) = a(-(x + \Delta)) + a(1 - \Delta) \ge a(-x) = a(x).
$$

Тем самым, $a(x) = a(x + \Delta)$.
\end{proof}

\begin{lm}
\label{lm:weight_max_sum_concave}
Пусть функции $a_1$ и $a_2$ удовлетворяют неравенству $(\ref{eq:almostConcave})$.
Тогда функции $\max (a_1(x), a_2(x))$ и $a_1(x) + a_2(x)$ тоже ему удовлетворяет.
\end{lm}
\begin{proof}
Положим $a(x) = \max (a_1(x), a_2(x))$.
Тогда
\begin{multline*}
a(1 - t + s) = \max(a_1( 1 - t + s), a_2(1 - t + s)) \le
\max(a_1(s) + a_1(t), a_2(s) + a_2(t)) \\
\le \max(a_1(s), a_2(s)) + \max(a_1(t), a_2(t)) =
a(s) + a(t).
\end{multline*}

Утверждение для функции $a(x) = a_1(x) + a_2(x)$ очевидно.
\end{proof}

\begin{lm}
\label{lm:weight_piecewise_linear_concave}
Пусть функция $a$ удовлетворяет неравенству $(\ref{eq:almostConcave})$, $k \in \Nat$.
Тогда кусочно линейная функция $a_k$, интерполирующая функцию $a$ по узлам
$(-1 + \frac{2i}{k})$, $i = 0, 1, \dots, k$, тоже удовлетворяет неравенству $(\ref{eq:almostConcave})$.
\end{lm}
\begin{proof}
\textbf{1.}
Пусть $s = -1 + \frac{2i}{k}$, $t = -1 + \frac{2j}{k}$.
Тогда неравенство выполняется для $a_k$, потому что оно выполняется для $a$,
а в этих точках они совпадают.

\textbf{2.}
Пусть теперь $s = -1 + \frac{2i}{k}$, и $t \in [-1 + \frac{2j}{k}, -1 + \frac{2(j + 1)}{k}]$.

Рассмотрим линейную функцию $h_1(t) = a_k( 1 - t + s ) - a_k(t) - a_k(s)$.
Из части 1 следует $h_1(-1 + \frac{2j}{k}) \le 0$ и $h_1(-1 + \frac{2(j + 1)}{k}) \le 0$.
Значит, поскольку $h_1$ линейна, $h_1(t) \le 0$.
Тем самым, неравенство выполняется для любого $s = -1 + \frac{2i}{k}$ и $t \in [-1, 1]$.

\textbf{3.}
Пусть $s$ и $t$ удовлетворяют соотношению $1 - t + s = \frac{2j}{k}$.

Рассмотрим функцию $h_2(y) = a_k(\frac{2j}{k}) - a_k(s + y) - a_k(t + y)$.
Если взять $y_0$ такое, что $s + y_0$ --- один из узлов, то $t + y_0$ --- тоже узел.
Следовательно $h_2(y_0) = a(\frac{2j}{k}) - a(s + y_0) - a(t + y_0) \le 0$.
Поскольку $h_2$ линейна между подобными $y_0$, получаем $h_2(y) \le 0$ для всех допустимых $y$.

\textbf{4.}
Наконец, для произвольного $t \in [-1, 1]$ рассмотрим $h_3(s) = a_k( 1 - t + s ) - a_k(t) - a_k(s)$.
Заметим, что если $s$ или $1 - t + s$ являются узлами, то из частей 2 и 3 следует $h_3(s) \le 0$.
Поскольку $h_3$ линейна между такими $s$, имеем $h_3(s) \le 0$ для всех допустимых $s$, что завершает доказательство.
\end{proof}
